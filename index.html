<!DOCTYPE html>
<html>
<head>
<meta charset="UTF-8">
<title>#LIVE Audio Dashboard</title>

<style>
  body {
    margin: 0;
    background: #111;
    color: white;
    font-family: Arial, sans-serif;
    text-align: center;
    padding-bottom: 60px;
  }

  header {
    padding: 20px;
    background: linear-gradient(90deg, #ff002f, #ff7b00);
    box-shadow: 0 0 20px rgba(255,0,0,0.4);
  }

  header img {
    height: 100px;
  }

  h2 {
    margin-top: 20px;
    letter-spacing: 1px;
    text-transform: uppercase;
  }

  #controls button {
    padding: 12px 20px;
    margin: 10px;
    font-size: 16px;
    border: none;
    border-radius: 8px;
    cursor: pointer;
    background: #ff002f;
    color: white;
    transition: 0.2s;
  }

  #controls button:hover {
    background: #ff405c;
  }

  .playlist {
    margin-top: 25px;
    text-align: left;
    display: inline-block;
    background: #222;
    padding: 15px;
    border-radius: 12px;
    width: 280px;
    box-shadow: 0 0 12px rgba(255,0,0,0.3);
  }

  .track {
    padding: 8px;
    border-radius: 6px;
    cursor: pointer;
    color: #ccc;
  }

  .track:hover {
    background: #333;
  }

  .active {
    background: #ff002f;
    color: white;
    font-weight: bold;
  }

  .slider-container {
    margin-top: 25px;
  }

  #vol {
    width: 200px;
  }
</style>
</head>

<body>

<header>
  <img src="logo.png" alt="#LIVE Logo">
</header>

<h2>#LIVE Audio Dashboard</h2>

<audio id="player"></audio>

<div id="controls">
  <button onclick="prevTrack()">Prev</button>
  <button onclick="togglePlay()" id="playBtn">Play</button>
  <button onclick="nextTrack()">Next</button>
  <button onclick="toggleLoop()" id="loopBtn">Loop: Off</button>
</div>

<div class="slider-container">
  <input type="range" id="vol" min="0" max="1" step="0.01" value="1">
  <p>Volume</p>
</div>

<div class="playlist" id="playlistContainer">Loading songsâ€¦</div>

<script>
  const SONG_REPO = "https://lewisd049.github.io/hashtaglivesongs/";
  const player = document.getElementById("player");
  const playBtn = document.getElementById("playBtn");
  const loopBtn = document.getElementById("loopBtn");
  const playlistContainer = document.getElementById("playlistContainer");
  const volumeSlider = document.getElementById("vol");

  let playlist = [];
  let currentIndex = 0;

  async function loadSongs() {
    try {
      let res = await fetch(SONG_REPO);
      let text = await res.text();

      let mp3files = [...text.matchAll(/href="([^"]+\.mp3)"/g)].map(m => m[1]);

      playlist = mp3files.map(f => ({
        title: decodeURIComponent(f.replace(".mp3", "")),
        url: SONG_REPO + f
      }));

      renderPlaylist();
      loadTrack(0);
    } catch (err) {
      playlistContainer.innerHTML = "Error loading songs.";
    }
  }

  function renderPlaylist() {
    playlistContainer.innerHTML = "";
    playlist.forEach((track, i) => {
      const div = document.createElement("div");
      div.className = "track" + (i === currentIndex ? " active" : "");
      div.innerText = track.title;
      div.onclick = () => loadTrack(i);
      playlistContainer.appendChild(div);
    });
  }

  function loadTrack(i) {
    currentIndex = i;
    player.src = playlist[currentIndex].url;
    renderPlaylist();
    player.play();
    playBtn.innerText = "Pause";
  }

  function togglePlay() {
    if (player.paused) {
      player.play();
      playBtn.innerText = "Pause";
    } else {
      player.pause();
      playBtn.innerText = "Play";
    }
  }

  function nextTrack() {
    currentIndex = (currentIndex + 1) % playlist.length;
    loadTrack(currentIndex);
  }

  function prevTrack() {
    currentIndex = (currentIndex - 1 + playlist.length) % playlist.length;
    loadTrack(currentIndex);
  }

  function toggleLoop() {
    player.loop = !player.loop;
    loopBtn.innerText = "Loop: " + (player.loop ? "On" : "Off");
  }

  player.onended = () => {
    if (!player.loop) nextTrack();
  };

  volumeSlider.oninput = () => {
    player.volume = volumeSlider.value;
  };

  loadSongs();
</script>

</body>
</html>
